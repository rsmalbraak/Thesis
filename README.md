Thesis project for the Msc. Econometrics and Management Science specialisation in Business Analytics and Quantitative marketing at Erasmus University Rotterdam. 

Title: Hierarchical AC-GAN: Incorporating the Relations between Classes into the GAN’s Image Generation Process using Node2Vec to Aid in the Detection of COVID-19 in Chest X-rays. 

Author: Ruth Smalbraak

----------------------------------------------------------------------------------------------------------------
This repository contains the following files (with references to codes that we base our implementation on if applicable): 

DATA: 
* CXR_dataset_split.py: Contains code for creating the CXR dataset/rearranging the COVIDx V8A dataset into a new train/test split such that the train and test sets only contain images that originate from different datasets. Also provides the URLs to download the used datasets 
* CXR_split.csv : Contains all file names and labels of the images present in our CXR dataset from the COVIDx V8A dataset. Is used in CXR_dataset_split.py to create the new train/test split
* normal_Shenzhen.txt : Contains the file names of the 270 normal images used from the Shenzhen dataset
* Fruit : Contains five text files with file names of the apple, banana, lemon, lime and pear images used in the Fruit dataset (for replication purposes). Dataset an be downloaded from: https://www.kaggle.com/datasets/aelchimminut/fruits262
* Vegetable : Contains five text files with file names of the broccoli, capsicum, carrot, cauliflower and radish images used in the Vegetable dataset (for replication purposes). Dataset can be downloaded from: https://www.kaggle.com/datasets/misrakahmed/vegetable-image-dataset

GAN:
* AC-GAN.py: Contains code for the implemented customized AC-GAN (see thesis for explanation used modules and hyperparameter choices)
* HAC-GAN.py: Contains code for the implemented hierarchical AC-GAN, which used the Node2Vec graph embedding method to incorporate hierarchical relations between classes into GAN's image generating process (see thesis for explanation used modules and hyperparameter choices)
* Generate_CXR.py: Contains code for generating the synthetic CXRs after training AC-GAN or HAC-GAN

DTL:
* Classification_DTL_CXR.py: Contains code for the classification of COVID-19, non-COVID-19 pneumonia and normal classes using three different CNNs and DTL on the CXR training dataset, without augmentation
* Classification_DTL_aug.py: Contains code for the classification of COVID-19, non-COVID-19 pneumonia and normal classes using three different CNNs and DTL on the CXR training dataset augmented with images generated by HAC-GAN

EVALUATION: 
* fid.py: Contains code for computing the FID score between two datasets (image folders)
* ms_ssim.py: Contains  code for computing the MS-SSIM score between pairs of images
* create_gradcam.py: Contains the code to generate Grad-CAM visualizations of the decision process of CNNs. Imports and uses grad_cam.py
* gradcam.py: Contains code used in create_gradcam.py to generate Grad-CAM visualizations
* synset_words1.txt: Contains class indices and class names, used in create_gradcam.py

THESIS: 
* Thesis_453014rs.pdf : The final version of my Master's thesis
 
----------------------------------------------------------------------------------------------------------------

**Abstract:** The COVID-19 pandemic has a lasting effect on the global economy and population’s health. A main concern in detecting COVID-19 with deep learning methods such as convolutional neural networks (CNNs) remains the lack of datasets of sufficient size, which often leads to overfitting of the CNNs. In this research, we propose a customized Auxiliary Classifier GAN (AC-GAN) to synthesize chest X-rays (CXRs) that enlarge and balance the original dataset to aid in detecting COVID-19 in CXRs. AC-GAN models images belonging to different classes independently. However, classes can often be organized hierarchically, and their hierarchical relations contain valuable information which could provide useful clues for generating high-quality images. We therefore introduce Hierarchical AC-GAN (HAC-GAN), which aims to improve the quality and diversity of synthesized images by leveraging the relations between classes in the form of a hierarchy/graph in the GAN. We propose the Node2Vec graph embedding method to learn hierarchy-aware embeddings, which are fed to HAC-GAN to synthesize fake images. Experiments on three datasets show the effectiveness of HAC-GAN and demonstrate that it generates images that resemble the original dataset more closely than AC-GAN while producing a more diverse set of images. After augmenting the dataset with images from HAC-GAN, we employ deep transfer learning (DTL) to fine-tune several pre-trained CNNs for detecting COVID-19. The findings of this research reveal that the CNNs can accurately detect COVID-19 when trained on local data that is augmented by HAC-GAN. ResNet-18 performs best, and its accuracy increases to 98.5% after training on the augmented dataset. To leverage the potential of the proposed methods in practice, HAC-GAN and the CNNs need to be trained on local/“in-hospital” datasets.

-----------------------------------------------------------------------------------------------------------------
